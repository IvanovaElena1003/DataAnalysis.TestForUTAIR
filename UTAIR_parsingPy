{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ЭТАП 1. Получение данных, визуальный анализ структуры таблицы"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>H</th>\n",
       "      <th>CREATE_DATE</th>\n",
       "      <th>MODIFIED_DATE</th>\n",
       "      <th>REMOVED_DATE</th>\n",
       "      <th>DICTIONARY_CODE</th>\n",
       "      <th>CODE</th>\n",
       "      <th>NAME</th>\n",
       "      <th>PARENT_DICT_CODE</th>\n",
       "      <th>FUTURE_USE_1</th>\n",
       "      <th>FUTURE_USE_2</th>\n",
       "      <th>FUTURE_USE_3</th>\n",
       "      <th>FUTURE_USE_4</th>\n",
       "      <th>FUTURE_USE_5</th>\n",
       "      <th>FUTURE_USE_6</th>\n",
       "      <th>FUTURE_USE_7</th>\n",
       "      <th>FUTURE_USE_8</th>\n",
       "      <th>FUTURE_USE_9</th>\n",
       "      <th>FUTURE_USE_10,,,,</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>A</td>\n",
       "      <td>Активен</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>,,,,</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>S</td>\n",
       "      <td>Приостановлен</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>,,,,</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>I</td>\n",
       "      <td>Неактивен</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>,,,,</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>C</td>\n",
       "      <td>Закрыт</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>,,,,</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>D</td>\n",
       "      <td>Умер</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>,,,,</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   H          CREATE_DATE MODIFIED_DATE REMOVED_DATE DICTIONARY_CODE CODE  \\\n",
       "0  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    A   \n",
       "1  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    S   \n",
       "2  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    I   \n",
       "3  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    C   \n",
       "4  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    D   \n",
       "\n",
       "            NAME  PARENT_DICT_CODE FUTURE_USE_1  FUTURE_USE_2  FUTURE_USE_3  \\\n",
       "0        Активен               NaN           ru           NaN           NaN   \n",
       "1  Приостановлен               NaN           ru           NaN           NaN   \n",
       "2      Неактивен               NaN           ru           NaN           NaN   \n",
       "3         Закрыт               NaN           ru           NaN           NaN   \n",
       "4           Умер               NaN           ru           NaN           NaN   \n",
       "\n",
       "   FUTURE_USE_4  FUTURE_USE_5  FUTURE_USE_6  FUTURE_USE_7  FUTURE_USE_8  \\\n",
       "0           NaN           NaN           NaN           NaN           NaN   \n",
       "1           NaN           NaN           NaN           NaN           NaN   \n",
       "2           NaN           NaN           NaN           NaN           NaN   \n",
       "3           NaN           NaN           NaN           NaN           NaN   \n",
       "4           NaN           NaN           NaN           NaN           NaN   \n",
       "\n",
       "   FUTURE_USE_9 FUTURE_USE_10,,,,  \n",
       "0           NaN              ,,,,  \n",
       "1           NaN              ,,,,  \n",
       "2           NaN              ,,,,  \n",
       "3           NaN              ,,,,  \n",
       "4           NaN              ,,,,  "
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd #Обращение к библиотеке pandas\n",
    "\n",
    "df = pd.read_csv('GENERIC_DICTIONARIES_20151120000000.csv',sep = \"|\") #Чтение файла\n",
    "df.head() #Отображение первых 5-ти строк таблицы"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['H', 'CREATE_DATE', 'MODIFIED_DATE', 'REMOVED_DATE', 'DICTIONARY_CODE',\n",
       "       'CODE', 'NAME', 'PARENT_DICT_CODE', 'FUTURE_USE_1', 'FUTURE_USE_2',\n",
       "       'FUTURE_USE_3', 'FUTURE_USE_4', 'FUTURE_USE_5', 'FUTURE_USE_6',\n",
       "       'FUTURE_USE_7', 'FUTURE_USE_8', 'FUTURE_USE_9', 'FUTURE_USE_10,,,,'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns #Определение переченя названий столбцов таблицы df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>H</th>\n",
       "      <th>CREATE_DATE</th>\n",
       "      <th>MODIFIED_DATE</th>\n",
       "      <th>REMOVED_DATE</th>\n",
       "      <th>DICTIONARY_CODE</th>\n",
       "      <th>CODE</th>\n",
       "      <th>NAME</th>\n",
       "      <th>PARENT_DICT_CODE</th>\n",
       "      <th>FUTURE_USE_1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>A</td>\n",
       "      <td>Активен</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>S</td>\n",
       "      <td>Приостановлен</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>I</td>\n",
       "      <td>Неактивен</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>C</td>\n",
       "      <td>Закрыт</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>D</td>\n",
       "      <td>Умер</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   H          CREATE_DATE MODIFIED_DATE REMOVED_DATE DICTIONARY_CODE CODE  \\\n",
       "0  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    A   \n",
       "1  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    S   \n",
       "2  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    I   \n",
       "3  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    C   \n",
       "4  I  2015-11-20 09:32:56           NaN          NaN      ACC_STATUS    D   \n",
       "\n",
       "            NAME  PARENT_DICT_CODE FUTURE_USE_1  \n",
       "0        Активен               NaN           ru  \n",
       "1  Приостановлен               NaN           ru  \n",
       "2      Неактивен               NaN           ru  \n",
       "3         Закрыт               NaN           ru  \n",
       "4           Умер               NaN           ru  "
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = df.loc[:,'H':'FUTURE_USE_1'] #Срез первых 9 столбцов\n",
    "df.head() #Срез первых 5 строк таблицы\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ЭТАП 2. Подготовка таблицы дл анализа - удаление/замена пропусков, удаление дублей, удаление строк по условиям, переименование столбцов"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Проверка на таблицы на качество** "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 9799 entries, 0 to 9798\n",
      "Data columns (total 9 columns):\n",
      " #   Column            Non-Null Count  Dtype  \n",
      "---  ------            --------------  -----  \n",
      " 0   H                 9799 non-null   object \n",
      " 1   CREATE_DATE       9799 non-null   object \n",
      " 2   MODIFIED_DATE     78 non-null     object \n",
      " 3   REMOVED_DATE      128 non-null    object \n",
      " 4   DICTIONARY_CODE   9798 non-null   object \n",
      " 5   CODE              9798 non-null   object \n",
      " 6   NAME              9728 non-null   object \n",
      " 7   PARENT_DICT_CODE  0 non-null      float64\n",
      " 8   FUTURE_USE_1      9798 non-null   object \n",
      "dtypes: float64(1), object(8)\n",
      "memory usage: 689.1+ KB\n"
     ]
    }
   ],
   "source": [
    "df.info() #Получение общей информации о данных в таблице df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "ВЫВОДЫ проверки таблицы на качество:\n",
    "1. Колонка \"PARENT_DICT_CODE\" содержит только NaN значения\n",
    "2. Колонка \"REMOVED_DATE\" содержит 128 заполненных значений\n",
    "2. Колонка \"MODIFIED_DATE\" содержит 78 заполненных значений\n",
    "3. Колонка \"NAME\" содержит 9728 заполненных значений\n",
    "4. Колонка \"FUTURE_USE_1\",\"DICTIONARY_CODE\",\"CODE\" содержит одно значение «Nan»"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Редактирование таблицы, ЗАДАЧИ:\n",
    "1. Переименовать колонки: изменить верхний регистр на нижний\n",
    "4. Заменить «Nan» значения в \"removed_date\",\"modified_date\" и \"name\" на '-'\n",
    "3. Удалить строку, где Колонка \"future_use_1\"= \"Nan\"\n",
    "4. Проверить строки на дубликаты \n",
    "5. Удалить дублирующие строки при необходимости"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['h', 'create_date', 'modified_date', 'removed_date', 'dictionary_code',\n",
       "       'code', 'name', 'parent_dict_code', 'future_use_1'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# ЗАДАЧА 1.Переименование колонок: изменение верхнего регистра на нижний\n",
    "df.set_axis(['h', 'create_date', 'modified_date', 'removed_date', 'dictionary_code',\n",
    "       'code', 'name', 'parent_dict_code', 'future_use_1'],axis = 'columns',inplace = True)\n",
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9671"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['removed_date'].isnull().sum() #Сумма значений \"Nan\" в колонке 'removed_date'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>h</th>\n",
       "      <th>create_date</th>\n",
       "      <th>modified_date</th>\n",
       "      <th>removed_date</th>\n",
       "      <th>dictionary_code</th>\n",
       "      <th>code</th>\n",
       "      <th>name</th>\n",
       "      <th>parent_dict_code</th>\n",
       "      <th>future_use_1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>A</td>\n",
       "      <td>Активен</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>S</td>\n",
       "      <td>Приостановлен</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>I</td>\n",
       "      <td>Неактивен</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>C</td>\n",
       "      <td>Закрыт</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>D</td>\n",
       "      <td>Умер</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>M</td>\n",
       "      <td>Объединен</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>O</td>\n",
       "      <td>Открыт</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>CRH_TITLE</td>\n",
       "      <td>MR</td>\n",
       "      <td>Г-н</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>CRH_TITLE</td>\n",
       "      <td>MS</td>\n",
       "      <td>Г-жа</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>2015-11-23 10:41:50</td>\n",
       "      <td>CRH_TITLE</td>\n",
       "      <td>MRS</td>\n",
       "      <td>Mrs</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   h          create_date modified_date         removed_date dictionary_code  \\\n",
       "0  I  2015-11-20 09:32:56             -                    -      ACC_STATUS   \n",
       "1  I  2015-11-20 09:32:56             -                    -      ACC_STATUS   \n",
       "2  I  2015-11-20 09:32:56             -                    -      ACC_STATUS   \n",
       "3  I  2015-11-20 09:32:56             -                    -      ACC_STATUS   \n",
       "4  I  2015-11-20 09:32:56             -                    -      ACC_STATUS   \n",
       "5  I  2015-11-20 09:32:56             -                    -      ACC_STATUS   \n",
       "6  I  2015-11-20 09:32:56             -                    -      ACC_STATUS   \n",
       "7  I  2015-11-20 09:32:56             -                    -       CRH_TITLE   \n",
       "8  I  2015-11-20 09:32:56             -                    -       CRH_TITLE   \n",
       "9  I  2015-11-20 09:32:56             -  2015-11-23 10:41:50       CRH_TITLE   \n",
       "\n",
       "  code           name parent_dict_code future_use_1  \n",
       "0    A        Активен                -           ru  \n",
       "1    S  Приостановлен                -           ru  \n",
       "2    I      Неактивен                -           ru  \n",
       "3    C         Закрыт                -           ru  \n",
       "4    D           Умер                -           ru  \n",
       "5    M      Объединен                -           ru  \n",
       "6    O         Открыт                -           ru  \n",
       "7   MR            Г-н                -           ru  \n",
       "8   MS           Г-жа                -           ru  \n",
       "9  MRS            Mrs                -           ru  "
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# ЗАДАЧА 2.Замена значений Nan в \"removed_date\",\"modified_date\" и \"name\" на '-'\n",
    "df['removed_date'] = df['removed_date'].fillna('-')\n",
    "df['modified_date'] = df['modified_date'].fillna('-')\n",
    "df['name'] = df['name'].fillna('-')\n",
    "df['parent_dict_code'] = df['parent_dict_code'].fillna('-')\n",
    "\n",
    "df.head(10) #Проверка"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 9798 entries, 0 to 9797\n",
      "Data columns (total 9 columns):\n",
      " #   Column            Non-Null Count  Dtype \n",
      "---  ------            --------------  ----- \n",
      " 0   h                 9798 non-null   object\n",
      " 1   create_date       9798 non-null   object\n",
      " 2   modified_date     9798 non-null   object\n",
      " 3   removed_date      9798 non-null   object\n",
      " 4   dictionary_code   9798 non-null   object\n",
      " 5   code              9798 non-null   object\n",
      " 6   name              9798 non-null   object\n",
      " 7   parent_dict_code  9798 non-null   object\n",
      " 8   future_use_1      9798 non-null   object\n",
      "dtypes: object(9)\n",
      "memory usage: 765.5+ KB\n"
     ]
    }
   ],
   "source": [
    "# ЗАДАЧА 3.Удаление строки, где колонка \"future_use_1\"= 'Nan'\n",
    "df.dropna(subset = ['future_use_1'], inplace = True) #Удаление строки, где в столбце 'future_use_1' содержитсся значение Nan\n",
    "df.info() #Проверка удаленной строки. Всего было 9899 значений, стало 9798 - все верно."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4899"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# ЗАДАЧА 4. Проверка строк на дубликаты\n",
    "df.duplicated().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 4899 entries, 0 to 4898\n",
      "Data columns (total 9 columns):\n",
      " #   Column            Non-Null Count  Dtype \n",
      "---  ------            --------------  ----- \n",
      " 0   h                 4899 non-null   object\n",
      " 1   create_date       4899 non-null   object\n",
      " 2   modified_date     4899 non-null   object\n",
      " 3   removed_date      4899 non-null   object\n",
      " 4   dictionary_code   4899 non-null   object\n",
      " 5   code              4899 non-null   object\n",
      " 6   name              4899 non-null   object\n",
      " 7   parent_dict_code  4899 non-null   object\n",
      " 8   future_use_1      4899 non-null   object\n",
      "dtypes: object(9)\n",
      "memory usage: 344.6+ KB\n"
     ]
    }
   ],
   "source": [
    "# ЗАДАЧА 5. Удаление дубликатов\n",
    "df = df.drop_duplicates().reset_index(drop = True)\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Все строки заполнены по первым девяти колонкам. Дубликатов нет**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ЭТАП 3. Анализ данных"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>h</th>\n",
       "      <th>create_date</th>\n",
       "      <th>modified_date</th>\n",
       "      <th>removed_date</th>\n",
       "      <th>dictionary_code</th>\n",
       "      <th>code</th>\n",
       "      <th>name</th>\n",
       "      <th>parent_dict_code</th>\n",
       "      <th>future_use_1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>A</td>\n",
       "      <td>Активен</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>S</td>\n",
       "      <td>Приостановлен</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>I</td>\n",
       "      <td>Неактивен</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>C</td>\n",
       "      <td>Закрыт</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>ACC_STATUS</td>\n",
       "      <td>D</td>\n",
       "      <td>Умер</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>COM_TYPE</td>\n",
       "      <td>1</td>\n",
       "      <td>Coupon</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>COM_TYPE</td>\n",
       "      <td>4</td>\n",
       "      <td>Facebook new elite tier</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>COM_TYPE</td>\n",
       "      <td>5</td>\n",
       "      <td>Facebook award</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>COM_TYPE</td>\n",
       "      <td>FP</td>\n",
       "      <td>Forgotten Password</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>COM_TYPE</td>\n",
       "      <td>AU</td>\n",
       "      <td>Member profile update</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    h          create_date modified_date removed_date dictionary_code code  \\\n",
       "0   I  2015-11-20 09:32:56             -            -      ACC_STATUS    A   \n",
       "1   I  2015-11-20 09:32:56             -            -      ACC_STATUS    S   \n",
       "2   I  2015-11-20 09:32:56             -            -      ACC_STATUS    I   \n",
       "3   I  2015-11-20 09:32:56             -            -      ACC_STATUS    C   \n",
       "4   I  2015-11-20 09:32:56             -            -      ACC_STATUS    D   \n",
       ".. ..                  ...           ...          ...             ...  ...   \n",
       "95  I  2015-11-20 09:32:56             -            -        COM_TYPE    1   \n",
       "96  I  2015-11-20 09:32:56             -            -        COM_TYPE    4   \n",
       "97  I  2015-11-20 09:32:56             -            -        COM_TYPE    5   \n",
       "98  I  2015-11-20 09:32:56             -            -        COM_TYPE   FP   \n",
       "99  I  2015-11-20 09:32:56             -            -        COM_TYPE   AU   \n",
       "\n",
       "                       name parent_dict_code future_use_1  \n",
       "0                   Активен                -           ru  \n",
       "1             Приостановлен                -           ru  \n",
       "2                 Неактивен                -           ru  \n",
       "3                    Закрыт                -           ru  \n",
       "4                      Умер                -           ru  \n",
       "..                      ...              ...          ...  \n",
       "95                   Coupon                -           ru  \n",
       "96  Facebook new elite tier                -           ru  \n",
       "97           Facebook award                -           ru  \n",
       "98       Forgotten Password                -           ru  \n",
       "99    Member profile update                -           ru  \n",
       "\n",
       "[100 rows x 9 columns]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Вывод уникальных типов статусов в алфавитном порядке**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['ACC_STATUS', 'ACT_STATUS', 'ACT_TYPE', 'APP_VARIANT',\n",
       "       'AWR_STATUS', 'AWR_TYPE', 'BRL_STATUS', 'BRL_TYPE', 'BTC_STATUS',\n",
       "       'CASE_TYPE', 'COM_CHANNEL', 'COM_STATUS', 'COM_TYPE',\n",
       "       'CON_CHANNEL', 'CON_STATUS', 'COUNTRIES', 'CRH_GENDER',\n",
       "       'CRH_TITLE', 'CUS_SUBTYPE', 'CUS_TYPE', 'ENROLL_CHANNEL',\n",
       "       'MAQ_STATUS', 'MBR_STATUS_CHANGE_SOURCE_CODE', 'NNT_STATUS',\n",
       "       'NON_STATUS', 'PREF_LANGUAGES', 'PRT_INDUSTRY', 'PRT_STATUS',\n",
       "       'PRT_TYPE', 'QSN_TYPE', 'QST_CUS_STATUS', 'RDI_STATUS', 'RR_CODE',\n",
       "       'SEG_STATUS', 'SRV_STATUS', 'STATES', 'TRN_CHANNEL', 'TRN_STATUS',\n",
       "       'USR_STATUS', 'USR_TYPE', 'VOU_STATUS', 'VOU_TYPE'], dtype=object)"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sort_status_df= df['dictionary_code'].sort_values(ascending = True) #Сортировка\n",
    "sort_status_df = sort_status_df.unique() #Поиск уникальных значений\n",
    "sort_status_df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Подсчет значений 'Name' в каждом типе статусов**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dictionary_code\n",
       "ACC_STATUS                          7\n",
       "ACT_STATUS                          3\n",
       "ACT_TYPE                           39\n",
       "APP_VARIANT                         3\n",
       "AWR_STATUS                          3\n",
       "AWR_TYPE                            8\n",
       "BRL_STATUS                          3\n",
       "BRL_TYPE                           19\n",
       "BTC_STATUS                          6\n",
       "CASE_TYPE                           6\n",
       "COM_CHANNEL                         3\n",
       "COM_STATUS                          6\n",
       "COM_TYPE                           67\n",
       "CON_CHANNEL                         4\n",
       "CON_STATUS                          2\n",
       "COUNTRIES                         249\n",
       "CRH_GENDER                          2\n",
       "CRH_TITLE                          20\n",
       "CUS_SUBTYPE                         4\n",
       "CUS_TYPE                            2\n",
       "ENROLL_CHANNEL                      5\n",
       "MAQ_STATUS                          8\n",
       "MBR_STATUS_CHANGE_SOURCE_CODE       3\n",
       "NNT_STATUS                          6\n",
       "NON_STATUS                          4\n",
       "PREF_LANGUAGES                     10\n",
       "PRT_INDUSTRY                        6\n",
       "PRT_STATUS                          8\n",
       "PRT_TYPE                            3\n",
       "QSN_TYPE                           11\n",
       "QST_CUS_STATUS                      3\n",
       "RDI_STATUS                          3\n",
       "RR_CODE                             7\n",
       "SEG_STATUS                          3\n",
       "SRV_STATUS                          3\n",
       "STATES                           4331\n",
       "TRN_CHANNEL                         6\n",
       "TRN_STATUS                          6\n",
       "USR_STATUS                          2\n",
       "USR_TYPE                           10\n",
       "VOU_STATUS                          4\n",
       "VOU_TYPE                            1\n",
       "Name: name, dtype: int64"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.groupby('dictionary_code')['name'].count() #Группировка таблицы по 'dictionary_code', подсчет значений по стобцу 'Name' для каждого 'dictionary_code'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "116.64285714285714"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.groupby('dictionary_code')['name'].count().mean() #Поиск среднего арифмитеческого количества значений в статусах"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4331"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.groupby('dictionary_code')['name'].count().max() #Поиск максимального количества значений в статусах"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Вывод таблицы, в которой dictionary_code = STATES**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>h</th>\n",
       "      <th>create_date</th>\n",
       "      <th>modified_date</th>\n",
       "      <th>removed_date</th>\n",
       "      <th>dictionary_code</th>\n",
       "      <th>code</th>\n",
       "      <th>name</th>\n",
       "      <th>parent_dict_code</th>\n",
       "      <th>future_use_1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>523</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AD-07</td>\n",
       "      <td>Andorra la Vella</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>524</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AD-02</td>\n",
       "      <td>Canillo</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>525</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AD-03</td>\n",
       "      <td>Encamp</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>526</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AD-08</td>\n",
       "      <td>Escaldes-Engordany</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>527</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AD-04</td>\n",
       "      <td>La Massana</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>528</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AD-05</td>\n",
       "      <td>Ordino</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>529</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AD-06</td>\n",
       "      <td>Sant Julia de Loria</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>530</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AO-BGO</td>\n",
       "      <td>Bengo</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>531</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AO-BGU</td>\n",
       "      <td>Benguela</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>532</th>\n",
       "      <td>I</td>\n",
       "      <td>2015-11-20 09:32:56</td>\n",
       "      <td>-</td>\n",
       "      <td>-</td>\n",
       "      <td>STATES</td>\n",
       "      <td>AO-BIE</td>\n",
       "      <td>Bié</td>\n",
       "      <td>-</td>\n",
       "      <td>ru</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     h          create_date modified_date removed_date dictionary_code  \\\n",
       "523  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "524  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "525  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "526  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "527  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "528  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "529  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "530  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "531  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "532  I  2015-11-20 09:32:56             -            -          STATES   \n",
       "\n",
       "       code                 name parent_dict_code future_use_1  \n",
       "523   AD-07     Andorra la Vella                -           ru  \n",
       "524   AD-02              Canillo                -           ru  \n",
       "525   AD-03               Encamp                -           ru  \n",
       "526   AD-08   Escaldes-Engordany                -           ru  \n",
       "527   AD-04           La Massana                -           ru  \n",
       "528   AD-05               Ordino                -           ru  \n",
       "529   AD-06  Sant Julia de Loria                -           ru  \n",
       "530  AO-BGO                Bengo                -           ru  \n",
       "531  AO-BGU             Benguela                -           ru  \n",
       "532  AO-BIE                  Bié                -           ru  "
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_STATES = df.loc[df['dictionary_code'] == 'STATES']\n",
    "df_STATES.head(10) #Отображение первых 10-ти значений"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ЭТАП 4. Результаты"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_STATES.to_csv('DF_STATES.csv', sep = \";\") #Запись таблицы, в которой dictionary_code = STATES, в новый документ"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
